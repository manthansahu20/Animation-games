<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Letter üíñ</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:Poppins,sans-serif;
}

body{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at top,#ff9a9e,#fad0c4);
  overflow:hidden;
}

.container{
  text-align:center;
  color:white;
}

.title{
  margin-bottom:20px;
}

/* Envelope */
.envelope{
  width:320px;
  height:210px;
  background:#ff4d6d;
  border-radius:14px;
  position:relative;
  cursor:pointer;
  box-shadow:0 20px 40px rgba(0,0,0,.3);
}

/* Flap */
.flap{
  position:absolute;
  inset:0;
  background:#ff1e56;
  clip-path:polygon(0 0,50% 55%,100% 0);
  transform-origin:top;
  transition:.6s ease;
  z-index:3;
}

.envelope.open .flap{
  transform:rotateX(180deg);
}

/* Letter */
.letter{
  position:absolute;
  width:90%;
  height:85%;
  left:5%;
  top:90px;                 /* hidden */
  background:white;
  border-radius:10px;
  padding:14px;
  transition:.8s ease;
  z-index:2;
  overflow:hidden;          /* üîí HARD STOP */
}

.envelope.open .letter{
  top:-55px;                /* comes out */
}

.letter h3{
  color:#ff1e56;
  margin-bottom:6px;
}

/* Text area strictly inside paper */
.text-box{
  max-height:110px;
  overflow:hidden;          /* üîí text never goes out */
  font-size:14px;
  color:#333;
}

.from{
  font-size:12px;
  color:#777;
  margin-top:8px;
  text-align:right;
}

/* Hearts */
.hearts{
  position:absolute;
  bottom:8px;
  left:50%;
  transform:translateX(-50%);
  pointer-events:none;
}

.heart{
  position:absolute;
  font-size:18px;
  animation:rise 2s ease forwards;
}

@keyframes rise{
  0%{ transform:translate(0,0) scale(.6); opacity:1;}
  100%{ transform:translate(var(--x),-180px) scale(1.4); opacity:0;}
}

.hint{
  margin-top:15px;
  font-size:14px;
}
</style>
</head>

<body>

<div class="container">
  <h1 class="title">üíå A Letter From My Heart</h1>

  <div class="envelope" id="envelope">
    <div class="flap"></div>

    <div class="letter">
      <h3>My Love ‚ù§Ô∏è</h3>

      <div class="text-box" id="text"></div>

      <div class="from">‚Äî Yours, Always</div>

      <div class="hearts" id="hearts"></div>
    </div>
  </div>

  <div class="hint">Tap the envelope üíó</div>
</div>

<script>
const envelope = document.getElementById("envelope");
const textBox = document.getElementById("text");
const heartsBox = document.getElementById("hearts");

const message =
"You came into my life quietly, but changed everything forever.\n\n"+
"You are my calm, my favorite thought, and my forever. ‚ù§Ô∏è";

let i = 0;
let typingTimer = null;
let heartTimer = null;

envelope.onclick = () => {
  if(envelope.classList.contains("open")){
    closeAll();
  }else{
    openAll();
  }
};

function openAll(){
  envelope.classList.add("open");
  resetAll();
  typeText();
  startHearts();
}

function closeAll(){
  envelope.classList.remove("open");
  resetAll();
}

function resetAll(){
  clearTimeout(typingTimer);
  clearInterval(heartTimer);
  i = 0;
  textBox.innerHTML = "";
  heartsBox.innerHTML = "";
}

function typeText(){
  if(i < message.length){
    textBox.innerHTML += message[i] === "\n" ? "<br><br>" : message[i];
    i++;
    typingTimer = setTimeout(typeText,40);
  }
}

function startHearts(){
  heartTimer = setInterval(()=>{
    const h = document.createElement("div");
    h.className = "heart";
    h.innerHTML = "üíñ";
    h.style.setProperty("--x",(Math.random()*100-50)+"px");
    heartsBox.appendChild(h);
    setTimeout(()=>h.remove(),2000);
  },200);
}
</script>

</body>
</html>
