<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Grand Love Reveal</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <style>
        :root {
            --env-bg: #c0392b;
            --env-flap: #e74c3c;
            --paper: #ffffff;
            --heart: #ff2d55;
        }

        body, html {
            margin: 0; padding: 0; height: 100%; overflow: hidden;
            background: #0f0c29; font-family: 'Poppins', sans-serif;
            display: flex; align-items: center; justify-content: center;
        }

        /* --- Phase 1: Gateway --- */
        #gateway {
            position: fixed; inset: 0; z-index: 100; display: flex;
            align-items: center; justify-content: center; background: #000;
            transition: 1s cubic-bezier(0.8, 0, 0.2, 1);
        }
        .premium-card {
            text-align: center; border: 1px solid rgba(255,255,255,0.1);
            padding: 50px; border-radius: 30px; background: rgba(255,255,255,0.05);
            backdrop-filter: blur(20px); box-shadow: 0 0 50px rgba(231, 76, 60, 0.2);
        }
        h1 { font-family: 'Great Vibes', cursive; font-size: 3.5rem; color: #e74c3c; margin-bottom: 20px; }
        input {
            padding: 15px; border-radius: 50px; border: 2px solid #e74c3c;
            background: transparent; color: white; text-align: center; width: 280px;
            font-size: 1.1rem; margin-bottom: 25px; outline: none;
        }
        .unlock-btn {
            background: #e74c3c; color: white; border: none; padding: 15px 50px;
            border-radius: 50px; font-weight: bold; cursor: pointer; letter-spacing: 2px;
            transition: 0.3s;
        }

        /* --- Phase 2: The Envelope --- */
        #mainScene { display: none; position: relative; perspective: 1500px; z-index: 10; }

        .envelope-wrapper {
            position: relative; width: 350px; height: 230px;
            background: var(--env-bg); cursor: pointer;
            box-shadow: 0 30px 60px rgba(0,0,0,0.6);
            transform-style: preserve-3d;
        }

        /* Flap */
        .flap {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--env-flap); clip-path: polygon(0 0, 50% 60%, 100% 0);
            z-index: 5; transform-origin: top; transition: 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Front Covers */
        .envelope-wrapper::before {
            content: ""; position: absolute; inset: 0; background: var(--env-flap);
            clip-path: polygon(0 0, 50% 60%, 0 100%); z-index: 4;
        }
        .envelope-wrapper::after {
            content: ""; position: absolute; inset: 0; background: var(--env-flap);
            clip-path: polygon(100% 0, 50% 60%, 100% 100%); z-index: 4;
        }
        .bottom-cap {
            position: absolute; inset: 0; background: var(--env-bg);
            clip-path: polygon(0 100%, 50% 60%, 100% 100%); z-index: 4;
        }

        /* The Letter */
        .letter {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
            width: 90%; height: 90%; background: var(--paper); padding: 30px;
            border-radius: 5px; z-index: 2; transition: 1s cubic-bezier(0.6, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(0,0,0,0.1); overflow: hidden;
        }

        .letter-text {
            font-family: 'Great Vibes', cursive; font-size: 2rem;
            color: #c0392b; line-height: 1.3; text-align: center; opacity: 0;
            transition: 0.5s 1s;
        }

        /* Floating Hearts Container */
        #heart-fountain { position: absolute; inset: 0; pointer-events: none; z-index: 20; }

        /* Animation Triggered */
        .envelope-wrapper.is-open .flap { transform: rotateX(180deg); z-index: 1; }
        .envelope-wrapper.is-open .letter { transform: translate(-50%, -220px) scale(1.15); z-index: 10; height: 420px; }
        .envelope-wrapper.is-open .letter-text { opacity: 1; }

        .instruction { color: white; margin-top: 50px; opacity: 0.5; text-transform: uppercase; letter-spacing: 3px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <audio id="loveSong" loop><source src="https://www.bensound.com/bensound-music/bensound-love.mp3" type="audio/mpeg"></audio>

    <div id="gateway">
        <div class="premium-card">
            <h1>The Royal Invitation</h1>
            <input type="password" id="p" placeholder="Enter 'iloveyou'">
            <br>
            <button class="unlock-btn" onclick="openVault()">UNSEAL</button>
        </div>
    </div>

    <div id="mainScene">
        <div id="heart-fountain"></div>
        <div class="envelope-wrapper" id="env" onclick="burstLove()">
            <div class="flap"></div>
            <div class="bottom-cap"></div>
            <div class="letter">
                <div class="letter-text">
                    My Dearest,<br><br>
                    You are the most beautiful chapter of my life. 
                    Every beat of my heart is a tribute to you.<br><br>
                    Thank you for being mine. ❤️
                </div>
            </div>
        </div>
        <center><p class="instruction">Click to Open the Heart</p></center>
    </div>

    <script>
        function openVault() {
            const val = document.getElementById('p').value.toLowerCase();
            if(val === "iloveyou") {
                document.getElementById('loveSong').play();
                gsap.to("#gateway", { y: -window.innerHeight, duration: 1.2, ease: "power4.inOut" });
                setTimeout(() => {
                    document.getElementById('mainScene').style.display = 'block';
                    gsap.from("#env", { scale: 0, rotation: 15, duration: 1, ease: "back.out" });
                }, 800);
            } else {
                gsap.to(".premium-card", { x: -10, repeat: 5, yoyo: true, duration: 0.05 });
            }
        }

        function burstLove() {
            const env = document.getElementById('env');
            if(env.classList.contains('is-open')) return;
            
            env.classList.add('is-open');
            document.querySelector('.instruction').style.opacity = '0';

            // Floating Hearts Burst
            for(let i=0; i<30; i++) {
                createHeart();
            }
        }

        function createHeart() {
            const fountain = document.getElementById('heart-fountain');
            const heart = document.createElement('div');
            heart.innerHTML = "❤️";
            heart.style.position = "absolute";
            heart.style.left = "50%";
            heart.style.top = "50%";
            heart.style.fontSize = Math.random() * 20 + 20 + "px";
            heart.style.zIndex = "20";
            fountain.appendChild(heart);

            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * 200 + 100;
            const destinationX = Math.cos(angle) * velocity;
            const destinationY = Math.sin(angle) * velocity - 200;

            gsap.to(heart, {
                x: destinationX,
                y: destinationY,
                opacity: 0,
                duration: 2 + Math.random(),
                delay: 0.5,
                ease: "power2.out",
                onComplete: () => heart.remove()
            });
        }
    </script>
</body>
</html>
