<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Neon Flappy Bird</title>
<style>
  /* ===== Root colors ===== */
  :root {
    --bg:#0d0d0d;
    --bird:#00ffff;
    --pipe:#ff00ff;
    --ground:#222;
    --score:#00ff99;
    --panel-bg:rgba(20,20,20,0.85);
    --btn-bg:#ff00cc;
    --btn-hover:#ff66ff;
  }
  html,body{margin:0;height:100%;font-family:Verdana,Arial,sans-serif;background:var(--bg);}
  .wrap{display:flex;justify-content:center;align-items:center;height:100%;padding:20px;box-sizing:border-box}
  .game-box{width:100%;max-width:600px;background:transparent;position:relative;overflow:hidden;border-radius:12px;}
  canvas{display:block;width:100%;height:auto;background:var(--bg);cursor:pointer;}
  /* HUD */
  .hud{position:absolute;top:10px;left:10px;color:var(--score);font-weight:700;text-shadow:0 0 8px var(--score);}
  .score{font-size:28px;}
  .best{font-size:14px;opacity:.7;margin-top:4px;}
  /* Overlay */
  .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:auto;transition:opacity 0.3s ease;}
  .overlay.hidden{opacity:0;pointer-events:none;}
  .panel{background:var(--panel-bg);padding:20px 24px;border-radius:12px;text-align:center;color:#fff;box-shadow:0 0 20px rgba(255,255,255,0.2);}
  .panel h1{font-size:24px;margin:0 0 12px;text-shadow:0 0 10px var(--score);}
  .panel p{font-size:16px;margin:6px 0;}
  .btn{display:inline-block;margin-top:12px;padding:10px 16px;border-radius:10px;background:var(--btn-bg);cursor:pointer;font-weight:700;color:#fff;text-shadow:0 0 6px #fff;transition:0.3s;}
  .btn:hover{background:var(--btn-hover);text-shadow:0 0 12px #fff;}
  .ground-strip{position:absolute;bottom:0;width:100%;height:30px;background:var(--ground);}
</style>
</head>
<body>
<div class="wrap">
  <div class="game-box">
    <canvas id="game" width="800" height="600"></canvas>
    <div class="hud">
      <div class="score">Score: <span id="score">0</span></div>
      <div class="best">Best: <span id="best">0</span></div>
    </div>
    <div class="overlay" id="overlay">
      <div class="panel" id="panel">
        <h1>Neon Flappy Bird</h1>
        <p>Space / Tap / Click to flap. Survive as long as possible!</p>
        <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
          <div class="btn" id="startBtn">Start Game</div>
          <div class="btn" id="instrBtn">Instructions</div>
        </div>
      </div>
    </div>
    <div class="ground-strip"></div>
  </div>
</div>

<script>
(function(){
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const W=800,H=600;
canvas.width=W;canvas.height=H;

const scoreEl=document.getElementById('score');
const bestEl=document.getElementById('best');
const overlay=document.getElementById('overlay');
const panel=document.getElementById('panel');
const startBtn=document.getElementById('startBtn');
const instrBtn=document.getElementById('instrBtn');

let game=null;
const groundHeight=30;
const groundY=H-groundHeight;

// Audio
const audioCtx = window.AudioContext ? new AudioContext() : null;
function playBeep(freq=440,dur=0.05,type='sine',vol=0.12){
  if(!audioCtx)return;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.type=type;o.frequency.value=freq;g.gain.value=vol;o.connect(g);g.connect(audioCtx.destination);
  o.start();o.stop(audioCtx.currentTime+dur);
}

// Particle for collision
class Particle{
  constructor(x,y,color){this.x=x;this.y=y;this.vx=Math.random()*160-80;this.vy=Math.random()*-180-50;this.alpha=1;this.color=color;}
  update(dt){this.x+=this.vx*dt;this.y+=this.vy*dt;this.vy+=200*dt;this.alpha-=dt*1.5;}
  draw(ctx){ctx.globalAlpha=Math.max(this.alpha,0);ctx.fillStyle=this.color;ctx.fillRect(this.x,this.y,3,3);ctx.globalAlpha=1;}
}

// Bird with neon wing animation
class Bird{
  constructor(){this.x=W*0.28;this.y=H/2;this.r=18;this.vel=0;this.acc=900;this.flapPower=-320;this.angle=0;this.dead=false;this.wingPhase=0;}
  flap(){if(this.dead)return;this.vel=this.flapPower;playBeep(880,0.06);}
  update(dt){this.vel+=this.acc*dt;this.y+=this.vel*dt;this.angle=Math.max(-0.8,Math.min(1.2,this.vel/500));
    if(this.y+this.r>groundY){this.y=groundY-this.r;this.dead=true;}
    if(this.y-this.r<0){this.y=this.r;this.vel=0;}
    this.wingPhase+=dt*15;
  }
  draw(ctx){
    ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.angle);
    // body
    ctx.shadowBlur=10;ctx.shadowColor="#0ff";
    ctx.fillStyle="#0ff";ctx.beginPath();ctx.ellipse(0,0,this.r*1.3,this.r,0,0,2*Math.PI);ctx.fill();ctx.closePath();
    // wing
    ctx.fillStyle="#0ff";ctx.beginPath();ctx.ellipse(-4,Math.sin(this.wingPhase)*6,10,5,0,0,2*Math.PI);ctx.fill();ctx.closePath();
    // eye
    ctx.fillStyle="#fff";ctx.beginPath();ctx.arc(6,-4,3,0,2*Math.PI);ctx.fill();ctx.closePath();
    ctx.fillStyle="#000";ctx.beginPath();ctx.arc(7,-4,1.5,0,2*Math.PI);ctx.fill();ctx.closePath();
    // beak
    ctx.fillStyle="#ff0";ctx.beginPath();ctx.moveTo(14,0);ctx.lineTo(22,4);ctx.lineTo(14,8);ctx.fill();ctx.closePath();
    ctx.restore();ctx.shadowBlur=0;
  }
  getBounds(){return {left:this.x-this.r,right:this.x+this.r,top:this.y-this.r,bottom:this.y+this.r};}
}

// Pipe
class Pipe{
  constructor(x,gapY,gapSize,speed){this.x=x;this.width=70;this.gapY=gapY;this.gapSize=gapSize;this.speed=speed;this.passed=false;}
  update(dt){this.x-=this.speed*dt;}
  draw(ctx){
    ctx.shadowBlur=8;ctx.shadowColor="#f0f";ctx.fillStyle="#f0f";ctx.fillRect(this.x,0,this.width,this.gapY-this.gapSize/2);
    ctx.fillRect(this.x,this.gapY+this.gapSize/2,this.width,H-(this.gapY+this.gapSize/2)-groundHeight);ctx.shadowBlur=0;
  }
  getRects(){return [{left:this.x,right:this.x+this.width,top:0,bottom:this.gapY-this.gapSize/2},{left:this.x,right:this.x+this.width,top:this.gapY+this.gapSize/2,bottom:H-groundHeight}];}
}

// Game
class Game{
  constructor(){this.reset();}
  reset(){
    this.bird=new Bird();this.pipes=[];this.spawnTimer=0;this.spawnInterval=1.5;
    this.pipeSpeed=200;this.score=0;this.running=false;this.gameover=false;this.particles=[];}
  start(){this.reset();this.running=true;this.gameover=false;}
  update(dt){
    if(!this.running||this.gameover)return;
    this.bird.update(dt);this.spawnTimer+=dt;
    if(this.spawnTimer>=this.spawnInterval){this.spawnTimer=0;
      const gapSize=Math.max(100,180-this.score*0.5);const gapY=Math.random()*(groundY-120-100)+100;
      this.pipes.push(new Pipe(W+40,gapY,gapSize,this.pipeSpeed));
    }
    for(let p of this.pipes)p.update(dt);this.pipes=this.pipes.filter(p=>p.x+p.width>-40);
    const b=this.bird.getBounds();
    for(let p of this.pipes){
      if(!p.passed && p.x+p.width<b.left){p.passed=true;this.score++;playBeep(600,0.05);this.spawnInterval=Math.max(0.9,1.5-0.01*this.score);}
      for(let r of p.getRects()){if(rectIntersect(b,r))this.hit();}
    }
    if(this.bird.dead && !this.gameover)this.hit();
    this.particles=this.particles.filter(p=>p.alpha>0);this.particles.forEach(p=>p.update(dt));
  }
  hit(){
    this.gameover=true;this.running=false;playBeep(120,0.2,'square',0.2);
    for(let i=0;i<30;i++)this.particles.push(new Particle(this.bird.x,this.bird.y,'#f0f'));
  }
  draw(ctx){
    drawBackground(ctx);for(let p of this.pipes)p.draw(ctx);
    this.bird.draw(ctx);for(let p of this.particles)p.draw(ctx);
    ctx.fillStyle="var(--ground)";ctx.fillRect(0,groundY,W,groundHeight);
  }
}

function drawBackground(ctx){
  ctx.clearRect(0,0,W,H);
  for(let i=0;i<50;i++){
    ctx.fillStyle="rgba(0,255,255,0.05)";
    const x=Math.random()*W;
    const y=Math.random()*H;
    ctx.fillRect(x,y,2,2);
  }
}

function rectIntersect(a,b){return !(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom);}

// Loop
let last=performance.now();
function tick(now){const dt=Math.min(0.03,(now-last)/1000);last=now;if(game)game.update(dt);if(game)game.draw(ctx);if(game)scoreEl.textContent=game.score;requestAnimationFrame(tick);}

// Input
function onAction(){if(!game.running&&!game.gameover){game.start();hideOverlay();}if(!game.gameover)game.bird.flap();if(game.gameover)showGameOver();}
window.addEventListener('keydown',e=>{if(e.code==='Space'){e.preventDefault();onAction();}});
canvas.addEventListener('mousedown',e=>{onAction();});
canvas.addEventListener('touchstart',e=>{e.preventDefault();onAction();},{passive:false});

function hideOverlay(){overlay.classList.add('hidden');overlay.classList.remove('active');}
function showOverlay(){overlay.classList.add('active');overlay.classList.remove('hidden');}
function showGameOver(){
  panel.innerHTML=`<h1>Game Over</h1><p>Score: <strong>${game.score}</strong></p><div style="display:flex;gap:10px;justify-content:center;"><div class='btn' id='restart'>Restart</div></div>`;
  showOverlay();
  const best=Math.max(getBest(),game.score);localStorage.setItem('neon_best',best);bestEl.textContent=best;
  document.getElementById('restart').addEventListener('click',()=>{panel.innerHTML=originalPanelHtml;hideOverlay();startNewGame();});
}

function startNewGame(){game=new Game();hideOverlay();let t=0;const countdown=setInterval(()=>{t++;if(t===1)playBeep(880,0.08);if(t>=2){clearInterval(countdown);game.start();}},250);}
const originalPanelHtml=panel.innerHTML;
startBtn.addEventListener('click',()=>{panel.innerHTML=`<h1>Ready?</h1><p>Click / Tap to flap!</p><div style="display:flex;gap:10px;justify-content:center;"><div class='btn' id='go'>Go!</div></div>`;document.getElementById('go').addEventListener('click',()=>{panel.innerHTML=originalPanelHtml;startNewGame();});});
instrBtn.addEventListener('click',()=>{panel.innerHTML=`<h1>Instructions</h1><p>- Space / Tap / Click to flap<br>- Don't hit pipes or ground<br>- Score increases on every pipe passed</p><div style="display:flex;gap:10px;justify-content:center;"><div class='btn' id='back'>Back</div></div>`;document.getElementById('back').addEventListener('click',()=>{panel.innerHTML=originalPanelHtml;});});

function getBest(){return parseInt(localStorage.getItem('neon_best')||'0',10);}
bestEl.textContent=getBest();
game=new Game();
requestAnimationFrame(tick);

canvas.tabIndex=0;canvas.focus();
function resumeAudio(){if(audioCtx&&audioCtx.state==='suspended')audioCtx.resume();}
['mousedown','touchstart','keydown'].forEach(ev=>window.addEventListener(ev,resumeAudio,{once:true}));
})();
</script>
</body>
</html>
